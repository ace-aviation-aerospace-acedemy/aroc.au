<!DOCTYPE html>

<html lang="en">

<head>

    <!-- META -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <meta name="robots" content="" />
    <meta name="description" content="" />

    <!-- FAVICONS ICON -->
    <link rel="icon" href="images/favicon.png" type="image/x-icon+png" />
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png" />

    <!-- PAGE TITLE HERE -->
    <title>Aroc | Checkout</title>

    <!-- MOBILE SPECIFIC -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- BOOTSTRAP STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <!-- FONTAWESOME STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/fontawesome/css/font-awesome.min.css" />

    <!-- OWL CAROUSEL STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/owl.carousel.min.css">

    <!-- SLICK SLIDER STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/slick.css">
    <link rel="stylesheet" type="text/css" href="css/slick-theme.css">
    <!-- BOOTSTRAP SLECT BOX STYLE SHEET  -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap-select.min.css">
    <!-- MAGNIFIC POPUP STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/magnific-popup.min.css">
    <!-- LOADER STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/loader.min.css">
    <!-- MAIN STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <!-- FLATICON STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/flaticon.min.css">
    <!-- THEME COLOR CHANGE STYLE SHEET -->
    <link rel="stylesheet" class="skin" type="text/css" href="css/skin/skin-1.css">
    <!-- SIDE SWITCHER STYLE SHEET -->
    <link rel="stylesheet" type="text/css" href="css/switcher.css">






    <!-- REVOLUTION SLIDER CSS -->
    <link rel="stylesheet" type="text/css" href="plugins/revolution/revolution/css/settings.css">
    <!-- REVOLUTION NAVIGATION STYLE -->
    <link rel="stylesheet" type="text/css" href="plugins/revolution/revolution/css/navigation.css">

    <!-- GOOGLE FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Muli:wght@200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">

</head>

<body>

    <div class="page-wraper">

        <!-- HEADER START -->
        <header class="site-header header-style-4 mobile-sider-drawer-menu">

            <div class="sticky-header main-bar-wraper  navbar-expand-lg">
                <div class="main-bar">
                    <div class="container clearfix">

                        <div class="logo-header">
                            <div class="logo-header-inner logo-header-one">
                                <a href="index.html">
                                    <div class="aroc-logo">
                                        <img src="images/main-logo-dark.png" alt="AROC Training Australia" />
                                    </div>

                                </a>
                            </div>
                        </div>

                        <!-- NAV Toggle Button -->
                        <button id="mobile-side-drawer" data-target=".header-nav" data-toggle="collapse" type="button"
                            class="navbar-toggler collapsed">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar icon-bar-first"></span>
                            <span class="icon-bar icon-bar-two"></span>
                            <span class="icon-bar icon-bar-three"></span>
                        </button>

                        <div class="extra-nav header-2-nav">
                            <div class="extra-cell">
                                <div class="header-search">
                                    <a href="javascript:void(0);" class="header-search-icon"><i
                                            class="fa fa-search"></i></a>
                                </div>
                            </div>
                            <div class="extra-cell">
                                <div class="header-nav-request">
                                    (+61) 1300 336 366
                                </div>
                            </div>

                        </div>


                        <!-- MAIN Vav -->
                        <div class="nav-animation header-nav navbar-collapse collapse d-flex justify-content-center">

                            <ul class=" nav navbar-nav">
                                <li>
                                    <a href="index.html">Home</a>
                                </li>
                                <li>
                                    <a href="index.html#courses">Course</a>
                                </li>
                                <li><a href="index.html#about">About</a>

                                <li><a href="contact.html">Contact</a>

                                </li>




                            </ul>

                        </div>

                        <!-- SITE Search -->
                        <div id="search-toggle-block">
                            <div id="search">
                                <form role="search" id="searchform" action="" method="get" class="radius-xl">
                                    <div class="input-group">
                                        <input class="form-control" value="" name="q" type="search"
                                            placeholder="Type to search" />
                                        <span class="input-group-append"><button type="button" class="search-btn"
                                                title="Search"><i class="fa fa-search"></i></button></span>
                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </header>
        <!-- HEADER END -->

        <!-- CONTENT START -->
        <div class="page-content">

            <!-- INNER PAGE BANNER -->
            <div class="wt-bnr-inr overlay-wraper bg-center" style="background-image:url(images/banner/5.jpg);">
                <div class="overlay-main site-bg-primary opacity-09"></div>
                <div class="container">
                    <div class="wt-bnr-inr-entry">
                        <div class="banner-title-outer">
                            <div class="banner-title-name">
                                <h2 class="site-text-white">Checkout</h2>
                            </div>
                        </div>
                        <!-- BREADCRUMB ROW -->

                        <div>
                            <ul class="wt-breadcrumb breadcrumb-style-2">
                                <li><a href="index.html">Home</a></li>
                                <li>Checkout</li>
                            </ul>
                        </div>

                        <!-- BREADCRUMB ROW END -->
                    </div>
                </div>
            </div>
            <!-- INNER PAGE BANNER END -->

            <!-- SECTION CONTENT START -->
            <div class="section-full p-t80 p-b50">

                <!-- PRODUCT DETAILS -->
                <div class="container woo-entry">

                    <!-- SECTION CONTENT START -->
                    <div class="section-content">
                        <div class="row justify-content-center">

                            <div class="col-lg-6 col-md-12 m-b30">



                                <div class="checkout-billing-form">

                                    <div class="wt-title m-b30">
                                        <h3>Billing Information</h3>
                                    </div>
                                    <form>

                                        <div class="row">
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>First Name *</label>
                                                    <input type="text" id="firstName" class="form-control"
                                                        placeholder="First Name" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>Last Name *</label>
                                                    <input type="text" id="lastName" class="form-control"
                                                        placeholder="Last Name" required>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label>Company Name</label>
                                            <input type="text" id="companyName" class="form-control"
                                                placeholder="Company Name">
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>Phone *</label>
                                                    <input type="text" id="phone" class="form-control"
                                                        placeholder="Enter Phone Number" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>Email Address *</label>
                                                    <input type="email" id="email" class="form-control"
                                                        placeholder="Enter email" required>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>Country</label>
                                                    <select id="country" class="form-control selectpicker"
                                                        title="Select Country">
                                                        <option value="Australia">Australia</option>
                                                        <option value="New Zealand">New Zealand</option>
                                                        <option value="United States">United States</option>
                                                        <option value="United Kingdom">United Kingdom</option>
                                                        <option value="Canada">Canada</option>
                                                        <option value="Other">Other</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>State / City</label>
                                                    <select id="state" class="form-control selectpicker"
                                                        title="Select State/City">
                                                        <option value="Queensland">Queensland</option>
                                                        <option value="New South Wales">New South Wales</option>
                                                        <option value="Victoria">Victoria</option>
                                                        <option value="Western Australia">Western Australia</option>
                                                        <option value="South Australia">South Australia</option>
                                                        <option value="Tasmania">Tasmania</option>
                                                        <option value="Northern Territory">Northern Territory</option>
                                                        <option value="Australian Capital Territory">Australian Capital
                                                            Territory</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>Post Code</label>
                                                    <input type="text" id="postCode" class="form-control"
                                                        placeholder="Post Code">
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-sm-6">
                                                <div class="form-group">
                                                    <label>Address</label>
                                                    <input type="text" id="address" class="form-control"
                                                        placeholder="Address">
                                                </div>
                                            </div>
                                        </div>

                                    </form>
                                </div>
                            </div>

                            <div class="col-lg-6 col-md-12 m-b30">




                                <div class="your-order-list">
                                    <div class="wt-title m-b30">
                                        <h3>Your Order</h3>
                                    </div>
                                    <ul id="order-summary">
                                        <li id="course-name">Loading...</li>
                                        <li id="original-price" style="display: none;"><b>Original Price </b><strong
                                                id="original-price-amount">Loading...</strong></li>
                                        <li id="discount-info" style="display: none;"><b>Discount</b><strong
                                                id="discount-amount" style="color: #28a745;">Loading...</strong></li>
                                        <li><b>Course Total</b><strong id="course-price">Loading...</strong></li>
                                        <li><b>Total Amount</b><strong id="total-amount">Loading...</strong></li>
                                    </ul>
                                    <div class="place-order text-right">
                                        <button type="button" class="site-button site-btn-effect"
                                            onclick="placeOrder()">Place Order</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- SECTION CONTENT END -->

                </div>
                <!-- PRODUCT DETAILS -->

            </div>
            <!-- CONTENT CONTENT END -->
        </div>
        <!-- CONTENT END -->
        <!-- FOOTER START -->
        <footer class="site-footer footer-large footer-dark text-white footer-style1">


            <!-- FOOTER BLOCKES START -->
            <div class="footer-top">
                <div class="container">
                    <div class="row">

                        <div class="col-lg-4 col-md-6">

                            <div class="widget recent-posts-entry">
                                <h3 class="widget-title">Get in Touch</h3>
                                <ul class="widget_address">
                                    <li><i class="fa fa-map-marker"></i>L2/18 Mt Gravatt Capalaba Road, 4122, Brisbane,
                                        Australia
                                    </li>
                                    <li><i class="fa fa-envelope"></i>hello@aroc.au</li>
                                    <li> <i class="fa fa-phone"></i>(+61) 1300 336 366</li>
                                </ul>
                            </div>
                        </div>


                        <div class="col-lg-4 col-md-6">
                            <div class="widget widget_services">
                                <h3 class="widget-title">Useful links</h3>
                                <ul>
                                    <li><a href="#about">About</a></li>
                                    <li><a href="#courses">Courses</a></li>
                                    <li><a href="contact.html">Contact us</a></li>
                                </ul>
                            </div>
                        </div>

                        <div class="col-lg-4 col-md-6">
                            <div class="widget widget_newsletter">
                                <h3 class="widget-title">Newsletter</h3>
                                <p>Join our subscribers list to get the latest AROC training updates, course
                                    announcements and aviation industry news delivered directly in your inbox.</p>
                                <div class="newsletter-input">
                                    <div class="input-group">
                                        <input id="email" type="text" class="form-control" name="email"
                                            placeholder="Enter your email">
                                        <div class="input-group-append">
                                            <button type="submit"
                                                class="input-group-text nl-search-btn text-black site-bg-primary title-style-2">Subscribe</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>
            <!-- FOOTER COPYRIGHT -->

            <div class="footer-middle">

                <div class="container">
                    <div class="footer-middle-content">
                        <div class="logo-footer">
                            <a href="index.html">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <img src="images/main-logo-dark.png" alt="AROC Training Australia"
                                        style="max-height: 50px;">
                                    <img src="images/ace-logo-white.png" alt="ACE" style="max-height: 50px;">
                                </div>
                            </a>
                        </div>

                        <ul class="copyrights-nav">
                            <li><a href="javascript:void(0);">Terms & Condition</a></li>
                            <li><a href="javascript:void(0);">Privacy Policy</a></li>
                            <li><a href="contact-1.html">Contact Us</a></li>
                        </ul>

                        <ul class="social-icons  wt-social-links footer-social-icon">
                            <li><a href="javascript:void(0);" class="fa fa-facebook"></a></li>
                            <li><a href="javascript:void(0);" class="fa fa-twitter"></a></li>
                            <li><a href="javascript:void(0);" class="fa fa-linkedin"></a></li>
                        </ul>
                    </div>
                </div>

            </div>
            <div class="footer-bottom">
                <div class="container">
                    <div class="wt-footer-bot-left d-flex justify-content-center">
                        <span class="copyrights-text">© 2025 AROC Training Australia.
                    </div>
                </div>
            </div>


        </footer>
        <!-- FOOTER END -->


        <!-- BUTTON TOP START -->
        <button class="scroltop" title="Scroll to top"><span class="fa fa-angle-up  relative"
                id="btn-vibrate"></span></button>

    </div>

    <!-- LOADING AREA START ===== -->
    <div class="loading-area">
        <div class="loading-box"></div>
        <div class="loading-pic">
            <div class="cssload-loader"></div>
        </div>
    </div>
    <!-- LOADING AREA  END ====== -->

    <!-- JAVASCRIPT  FILES ========================================= -->
    <script src="js/jquery-2.2.0.min.js"></script><!-- JQUERY.MIN JS -->
    <script src="js/popper.min.js"></script><!-- POPPER.MIN JS -->
    <script src="js/bootstrap.min.js"></script><!-- BOOTSTRAP.MIN JS -->
    <script src="js/bootstrap-select.min.js"></script><!-- Form js -->
    <script src="js/magnific-popup.min.js"></script><!-- MAGNIFIC-POPUP JS -->
    <script src="js/waypoints.min.js"></script><!-- WAYPOINTS JS -->
    <script src="js/counterup.min.js"></script><!-- COUNTERUP JS -->
    <script src="js/waypoints-sticky.min.js"></script><!-- STICKY HEADER -->
    <script src="js/isotope.pkgd.min.js"></script><!-- MASONRY  -->
    <script src="js/owl.carousel.min.js"></script><!-- OWL  SLIDER  -->
    <script src="js/stellar.min.js"></script><!-- PARALLAX BG IMAGE   -->
    <script src="js/theia-sticky-sidebar.js"></script><!-- STICKY SIDEBAR  -->
    <script src="js/jquery.bootstrap-touchspin.js"></script><!-- FORM JS -->
    <script src="js/custom.js"></script><!-- CUSTOM FUCTIONS  -->
    <script src="js/jquery.bgscroll.js"></script><!-- BACKGROUND SCROLL -->
    <script src="js/slick.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/api-service.js"></script>

    <!-- Checkout Script -->
    <script>
        // Get URL parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Update order summary
        async function updateOrderSummary() {
            const pkgId = getQueryParam('package') || 1;
            const pkg = await window.arocAPI.getPackageById(pkgId, {
                user: getQueryParam('user') ?? null,
                action: getQueryParam('action') ?? null
            });

            if (!pkg) {
                document.getElementById('course-name').innerHTML = 'Package Not Found';
                document.getElementById('course-price').innerHTML = '-';
                document.getElementById('total-amount').innerHTML = '-';
                return;
            }

            // Format price display using the API service
            const priceInfo = window.arocAPI.formatPriceDisplay(pkg);

            // Update course name
            document.getElementById('course-name').innerHTML = pkg.title + ' <strong>' + priceInfo.currentPrice + '</strong>';

            // Show/hide original price and discount if there's a discount
            const originalPriceElement = document.getElementById('original-price');
            const discountInfoElement = document.getElementById('discount-info');

            if (priceInfo.hasDiscount) {
                // Show original price and discount
                document.getElementById('original-price-amount').innerHTML = priceInfo.originalPrice;
                document.getElementById('discount-amount').innerHTML = '-' + priceInfo.savings.replace('save ', '');
                originalPriceElement.style.display = 'block';
                discountInfoElement.style.display = 'block';

                // Add strikethrough to original price
                document.getElementById('original-price-amount').style.textDecoration = 'line-through';
                document.getElementById('original-price-amount').style.color = '#6c757d';
            } else {
                // Hide original price and discount
                originalPriceElement.style.display = 'none';
                discountInfoElement.style.display = 'none';
            }

            // Update course total and total amount (both show the final discounted price)
            document.getElementById('course-price').innerHTML = priceInfo.currentPrice;
            document.getElementById('total-amount').innerHTML = priceInfo.currentPrice;

            // disabled
            function setInputValue(id, value) {
                const input = document.getElementById(id);
                if (!input) return;

                input.value = value;
                input.disabled = true; // disable the field

                // Dispatch events so listeners pick it up
                input.dispatchEvent(new Event('input', { bubbles: true }));
                input.dispatchEvent(new Event('change', { bubbles: true }));
            }

            if (pkg.user) {
                setInputValue('firstName', pkg.user.name.split(' ')[0] ?? '');
                setInputValue('lastName', pkg.user.name.split(' ')[1] ?? '');
                setInputValue('email', pkg.user.email);
                setInputValue('phone', pkg.user.profile.phone_number ?? '');
            }

        }

        // Place order function
        async function placeOrder() {
            // Get form data
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const companyName = document.getElementById('companyName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const country = document.getElementById('country').value;
            const state = document.getElementById('state').value;
            const postCode = document.getElementById('postCode').value.trim();
            const address = document.getElementById('address').value.trim();
            const pkgId = getQueryParam('package') || 1;

            // Detailed validation with specific error messages
            const validationErrors = [];
            console.log(email, phone, firstName, lastName, companyName, country, state, postCode, address);

            if (!firstName) {
                validationErrors.push('First Name is required');
            }

            if (!lastName) {
                validationErrors.push('Last Name is required');
            }

            if (!email) {
                validationErrors.push('Email Address is required');
            } else {
                // Email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    validationErrors.push('Please enter a valid email address');
                }
            }

            if (!phone) {
                validationErrors.push('Phone Number is required');
            } else {
                // Phone validation (basic)
                if (phone.length < 10) {
                    validationErrors.push('Please enter a valid phone number (minimum 10 digits)');
                }
            }

            // If there are validation errors, show them and stop
            if (validationErrors.length > 0) {
                alert('Please fix the following errors:\n\n' + validationErrors.join('\n'));
                return;
            }

            // Show loading state
            const placeOrderBtn = document.querySelector('button[onclick="placeOrder()"]');
            const originalBtnText = placeOrderBtn.innerHTML;
            placeOrderBtn.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Processing...';
            placeOrderBtn.disabled = true;

            try {
                // Prepare the payload
                const payload = {
                    package_id: parseInt(pkgId),
                    first_name: firstName,
                    last_name: lastName,
                    company_name: companyName || null,
                    phone: phone,
                    email: email,
                    country: country || null,
                    state: state || null,
                    zip: postCode || null,
                    address: address || null,
                    user: getQueryParam('user') ?? null,
                    action: getQueryParam('action') ?? null
                };

                // Make API request to checkout
                const response = await fetch('https://student.aroc.au/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                // Check if we have payment details and redirect URL
                if (data.payment_details && data.payment_details.stripe_session_url) {
                    // Redirect to Stripe checkout
                    window.location.href = data.payment_details.stripe_session_url;
                } else {
                    throw new Error('No payment session URL received from server');
                }

            } catch (error) {
                console.error('Checkout error:', error);

                // Show error message to user
                alert('Checkout failed: ' + error.message);

                // Reset button state
                placeOrderBtn.innerHTML = originalBtnText;
                placeOrderBtn.disabled = false;
            }
        }

        // Add form validation on input
        function validateForm() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();

            const placeOrderBtn = document.querySelector('button[onclick="placeOrder()"]');

            if (firstName && lastName && email && phone) {
                placeOrderBtn.disabled = false;
            } else {
                placeOrderBtn.disabled = true;
            }
        }

        // Add event listeners for real-time validation
        document.addEventListener('DOMContentLoaded', function () {
            updateOrderSummary();

            // Add input event listeners for real-time validation
            const requiredFields = ['firstName', 'lastName', 'email', 'phone'];
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', validateForm);
                    field.addEventListener('blur', validateForm);
                }
            });

            // Initial validation
            validateForm();
        });
    </script>
</body>

</html>